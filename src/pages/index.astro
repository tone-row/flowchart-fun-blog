---
import Layout from '../layouts/Layout.astro';
import { parse, format } from 'date-fns';
import { dateString, niceDate } from '../components/niceData';

const posts = (await Astro.glob('./posts/*.mdx')).map((post) => {
	const { frontmatter } = post;
	const title = frontmatter.title;
	const slug = post.url;
	const publishDate = niceDate(frontmatter.publishDate);
	const date = dateString(frontmatter.publishDate);
	const description = frontmatter.description;
	return { title, slug, publishDate, description, date };
});
---

<Layout title="Welcome to Astro.">
	<main>
		<header>
			<h1>Blog</h1>
			<p class="description">Documenting the process of developing Flowchart Fun</p>
		</header>
		<div class="blog-list">
			{posts.map((post) => (
				<article>
					<a href={post.slug} class="blog-post">
						<h2>{post.title}</h2>
						<time datetime={post.date} class="publish-date">{post.publishDate}</time>
						<p>{post.description}</p>
					</a>
				</article>
			))}
		</div>
	</main>
</Layout>

<style>
	header {
		display: grid;
		grid-template-columns: auto minmax(0, 1fr);
		align-items: baseline;
		gap: 1rem;
		margin-bottom: 50px;
	}

	.blog-list {
		display: grid;
		gap: 40px;
	}

	h2 {
		font-size: 24px;
		margin: 0;
	}

	a {
		display: grid;
		gap: 10px;
		text-decoration: none;
		color: black;
		border-radius: var(--border-radius);
	}
	a:focus-visible {
		outline-offset: 8px;
	}

	time {
		font-size: 14px;
	}

	p {
		margin: 0;
		color: var(--grey);
		font-size: 14px;
	}
</style>
